<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588</title><meta name="description" content="Documentation for ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588</h2></div>
<div class="tsd-panel tsd-typography"><p><a href="https://classroom.github.com/a/NApXvVde"><img src="https://classroom.github.com/assets/deadline-readme-button-24ddc0f5d75046c5622901739e7c5dd533143b0c8e959d652212380cedb1ea36.svg" alt="Review Assignment Due Date"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588/actions/workflows/coveralls.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588/actions/workflows/coveralls.yml/badge.svg" alt="Coveralls"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588/actions/workflows/node.js.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588/actions/workflows/node.js.yml/badge.svg" alt="Tests"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588/actions/workflows/sonarcloud.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-alu0101333588/actions/workflows/sonarcloud.yml/badge.svg" alt="Sonar-Cloud"></a></p>

<a href="#desarrollo-de-sistemas-informáticos--práctica-10--andrés-hernández-ortega" id="desarrollo-de-sistemas-informáticos--práctica-10--andrés-hernández-ortega" style="color: inherit; text-decoration: none;">
  <h6>Desarrollo de Sistemas Informáticos | Práctica 10 | Andrés Hernández Ortega</h6>
</a>

<a href="#práctica-10" id="práctica-10" style="color: inherit; text-decoration: none;">
  <h2>Práctica 10</h2>
</a>

<a href="#introducción" id="introducción" style="color: inherit; text-decoration: none;">
  <h1>Introducción</h1>
</a>
<p>En esta práctica continuaremos con las herramientas de GitHub Actions y Sonar Cloud. Además, introduciremos funcionalidades con los paquetes <code>yards</code> y <code>chalk</code> que nos posibilitarán introducir parametros durante la llamada a la ejecucción del programa y modificar el color y resaltado al imprimir por pantalla texto, así como, las funcionalidades que ofrece sockets para la conexión de un servidor con una serie de clientes, enviando y recibiendo información en ambas partes de las comunicaciones.</p>

<a href="#desarrollo" id="desarrollo" style="color: inherit; text-decoration: none;">
  <h1>Desarrollo</h1>
</a>

<a href="#ejercicio-1" id="ejercicio-1" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 1</h2>
</a>
<p>Considerando que se realizan dos modificaciones, primero una y después la otra:</p>

<a href="#pila-de-llamadas" id="pila-de-llamadas" style="color: inherit; text-decoration: none;">
  <h4>Pila de llamadas</h4>
</a>
<ul>
<li><p>Al comienzo está vacía</p>
</li>
<li><p>Con la llamada a la función access():</p>
<ul>
<li>access()</li>
</ul>
</li>
<li><p>Al ejecutar el callback de access() la pila está vacía.</p>
</li>
<li><p>Al llamar al console.log queda:</p>
<ul>
<li>console.log(<code>Starting to watch file ${filename}</code>);</li>
</ul>
</li>
<li><p>Al llamar a watch() queda:</p>
<ul>
<li>watch()</li>
</ul>
</li>
<li><p>Al llamar watcher.on():</p>
<ul>
<li>watcher.on()</li>
</ul>
</li>
<li><p>Al llamar al console.log():</p>
<ul>
<li>console.log(`File ${filename} is no longer watched)</li>
</ul>
</li>
<li><p>Con la primera modificación:</p>
<ul>
<li>watcher.on()</li>
<li>console.log(<code>File ${filename} has been modified somehow</code>);</li>
</ul>
</li>
<li><p>Con la segunda modificación:</p>
<ul>
<li>watcher.on()</li>
<li>console.log(<code>File ${filename} has been modified somehow</code>);</li>
</ul>
</li>
</ul>

<a href="#registro-de-eventos" id="registro-de-eventos" style="color: inherit; text-decoration: none;">
  <h4>Registro de eventos</h4>
</a>
<ul>
<li><p>Al comienzo del todo está vacío</p>
</li>
<li><p>Con la llamada a access queda:</p>
<ul>
<li>access</li>
</ul>
</li>
<li><p>Con la llamada a watcher queda:</p>
<ul>
<li>access</li>
<li>watcher</li>
</ul>
</li>
<li><p>Con la modificación de un archivo queda:</p>
<ul>
<li>access</li>
<li>watcher</li>
<li>change</li>
</ul>
</li>
<li><p>Con la modificación de otro archivo queda:</p>
<ul>
<li>access</li>
<li>watcher</li>
<li>change</li>
<li>change</li>
</ul>
</li>
</ul>

<a href="#cola-de-manejadores" id="cola-de-manejadores" style="color: inherit; text-decoration: none;">
  <h4>Cola de manejadores</h4>
</a>
<ul>
<li><p>Al comienzo del todo está vacío</p>
</li>
<li><p>Con la llamada a access queda:</p>
<ul>
<li>(err) =&gt;</li>
<li>() =&gt;</li>
</ul>
</li>
<li><p>Con la modificación de un archivo: </p>
<ul>
<li>(err) =&gt;</li>
<li>() =&gt;</li>
<li>() =&gt;</li>
</ul>
</li>
<li><p>Con la modificación de un segundo archivo: </p>
<ul>
<li>(err) =&gt;</li>
<li>() =&gt;</li>
<li>() =&gt;</li>
<li>() =&gt;</li>
</ul>
</li>
</ul>

<a href="#ejercicio-2" id="ejercicio-2" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 2</h2>
</a>
<p>Se ha posibilitado que el usuario introduzca un nombre de fichero con una serie de opciones posibles para mostrar el número de líneas, palabras, caracteres o combinar distintas opciones. Se ha llevado a cabo mediante el uso de yards para el paso de parametros en la llamada al programa, indicando la ruta del fichero y una o varias opciones, según desee. </p>
<p>En la opción con Pipe se resuelve de la siguiente manera: </p>
<pre><code><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">wc</span><span class="hl-1"> = </span><span class="hl-3">spawn</span><span class="hl-1">(</span><span class="hl-4">&#39;wc&#39;</span><span class="hl-1">, [</span><span class="hl-5">argumentos</span><span class="hl-1">, </span><span class="hl-5">nombreFichero</span><span class="hl-1">]);</span><br/><span class="hl-5">wc</span><span class="hl-1">.</span><span class="hl-5">stdout</span><span class="hl-1">.</span><span class="hl-3">pipe</span><span class="hl-1">(</span><span class="hl-5">process</span><span class="hl-1">.</span><span class="hl-5">stdout</span><span class="hl-1">);</span>
</code></pre>
<p>Como podemos observar, se ejecuta el comando <code>wc</code> para contar el número de líneas, palabras y caracteres del fichero, cuya ruta se específica en la variable <code>nombreFichero</code> y los argumentos en <code>argumentos</code>.</p>
<p>Sin emplear Pipe se ha resuelto de esta forma:</p>
<pre><code><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">wc</span><span class="hl-1"> = </span><span class="hl-3">spawn</span><span class="hl-1">(</span><span class="hl-4">&#39;wc&#39;</span><span class="hl-1">, [</span><span class="hl-5">nombreFichero</span><span class="hl-1">]);</span><br/><br/><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-5">wcOutput</span><span class="hl-1"> = </span><span class="hl-4">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">wc</span><span class="hl-1">.</span><span class="hl-5">stdout</span><span class="hl-1">.</span><span class="hl-3">on</span><span class="hl-1">(</span><span class="hl-4">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-5">piece</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-5">wcOutput</span><span class="hl-1"> += </span><span class="hl-5">piece</span><span class="hl-1">);   </span><br/><span class="hl-1">    </span><span class="hl-5">wc</span><span class="hl-1">.</span><span class="hl-3">on</span><span class="hl-1">(</span><span class="hl-4">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">wcOutputAsArray</span><span class="hl-1"> = </span><span class="hl-5">wcOutput</span><span class="hl-1">.</span><span class="hl-3">split</span><span class="hl-1">(</span><span class="hl-6">/\s</span><span class="hl-7">+</span><span class="hl-6">/</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><br/><span class="hl-1">    </span><span class="hl-8">if</span><span class="hl-1"> (</span><span class="hl-5">argv</span><span class="hl-1">.</span><span class="hl-5">lineas</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Hay </span><span class="hl-0">${</span><span class="hl-5">wcOutputAsArray</span><span class="hl-9">[</span><span class="hl-10">0</span><span class="hl-9">]</span><span class="hl-0">}</span><span class="hl-4"> líneas`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-8">if</span><span class="hl-1"> (</span><span class="hl-5">argv</span><span class="hl-1">.</span><span class="hl-5">caracteres</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Hay </span><span class="hl-0">${</span><span class="hl-5">wcOutputAsArray</span><span class="hl-9">[</span><span class="hl-10">2</span><span class="hl-9">]</span><span class="hl-0">}</span><span class="hl-4"> caracteres`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-8">if</span><span class="hl-1"> (</span><span class="hl-5">argv</span><span class="hl-1">.</span><span class="hl-5">palabras</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Hay </span><span class="hl-0">${</span><span class="hl-5">wcOutputAsArray</span><span class="hl-9">[</span><span class="hl-10">1</span><span class="hl-9">]</span><span class="hl-0">}</span><span class="hl-4"> palabras`</span><span class="hl-1">);</span><br/><span class="hl-1">    }  </span><br/><span class="hl-1">}); </span>
</code></pre>
<p>En el spawn no indicamos los argumentos que son en cuestión (<code>-l</code>, <code>-w</code>, <code>c</code>) sino que empleamos el comando <code>wc</code> directamente y en función de las opciones que se muestra por pantalla empleando simples <code>console.log</code>.</p>

<a href="#ejercicio-3" id="ejercicio-3" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 3</h2>
</a>
<p>Partiendo de la base de la anterior práctica establecemos un servidor que reciba una de las distintas opciones posibles (añadir nuevo usuario, añadir funko, modificar funko, eliminar funko, mostrar información de un funko en concreto o listar los funkos de un usuario) y un programa cliente que se podrá ejecutar varias veces, es decir, se tiene un servidor y se podrán establecer diferentes clientes.</p>
<p>El cliente recibe por parte del usuario por línea de comandos a la hora de la llamar al programa las opciones que desea realizar, empleando <code>yards</code> para ello, acto seguido el cliente lo convierte en una petición que realiza al servidor y que recibirá una respuesta por parte de éste que el cliente comunicará por pantalla al usuario. Por tanto, el usuario interactúa directamente con el cliente, sin tener relación directa con el servidor, pero sí obviamente de manera indirecta.</p>

<a href="#servidor" id="servidor" style="color: inherit; text-decoration: none;">
  <h3>Servidor</h3>
</a>
<p>El servidor se encuentra en un estado de escucha en el puerto <code>60500</code> esperando la conexión de clientes.</p>
<pre><code><span class="hl-5">servidor</span><span class="hl-1">.</span><span class="hl-3">listen</span><span class="hl-1">(</span><span class="hl-10">60500</span><span class="hl-1">, () </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">&quot;Esperando clientes...&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code></pre>
<p>Cuando recibe la comunicación de un nuevo cliente notifica por pantalla que un cliente se ha conectado y procesa la información que éste le envía, en esta caso se envía una petición:</p>
<pre><code><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">&quot;Un cliente se ha conectado&quot;</span><span class="hl-1">);</span><br/><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-5">funkoPops</span><span class="hl-1">: </span><span class="hl-11">Funko</span><span class="hl-1">[] = [];</span><br/><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-5">mensajeEntrante</span><span class="hl-1"> = </span><span class="hl-4">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-5">informacionPeticion</span><span class="hl-1"> : </span><span class="hl-11">informacion</span><span class="hl-1">;</span><br/><span class="hl-5">conexion</span><span class="hl-1">.</span><span class="hl-3">on</span><span class="hl-1">(</span><span class="hl-4">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-5">chunk</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">mensajeEntrante</span><span class="hl-1"> += </span><span class="hl-5">chunk</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">mensajeRecibido</span><span class="hl-1"> = </span><span class="hl-2">JSON</span><span class="hl-1">.</span><span class="hl-3">parse</span><span class="hl-1">(</span><span class="hl-5">chunk</span><span class="hl-1">.</span><span class="hl-3">toString</span><span class="hl-1">());</span><br/><span class="hl-1">    </span><span class="hl-5">informacionPeticion</span><span class="hl-1">= </span><span class="hl-5">mensajeRecibido</span><span class="hl-1">.</span><span class="hl-5">peticion</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">conexion</span><span class="hl-1">.</span><span class="hl-3">emit</span><span class="hl-1">(</span><span class="hl-5">informacionPeticion</span><span class="hl-1">.</span><span class="hl-5">accion</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code></pre>
<p>La petición que recibe el servidor contiene el nombre del usuario sobre el que se desea realizar las gestiones, opcional un id que corresponde con el del funko, la acción que desea realizar (añadir nuevo usuario, añadir funko, modificar funko, eliminar funko, mostrar información de un funko en concreto o listar los funkos de un usuario) y, opcionalmente, un objeto de tipo funko.</p>
<pre><code><span class="hl-12">nombreUsuario</span><span class="hl-1">: </span><span class="hl-5">string</span><span class="hl-1">;</span><br/><span class="hl-5">id</span><span class="hl-1">?: </span><span class="hl-5">number</span><span class="hl-1">;</span><br/><span class="hl-12">accion</span><span class="hl-1">: </span><span class="hl-5">acciones</span><span class="hl-1">;</span><br/><span class="hl-5">funko</span><span class="hl-1">?: </span><span class="hl-5">Funko</span><span class="hl-1">;</span>
</code></pre>
<p>Las distinas opciones que recibe se detectan mediante <code>conexion.emit(informacionPeticion.accion)</code>, comentado anteriormente, seguido de distintas <code>conexion.on</code> en función de la acción que haya indicado el cliente. En este caso, podemos observar como <code>nuevoUsuario</code> llama al constructor de un objeto de tipo <code>ColeccionFunkos</code> con el nombre del usuario en cuestión, para que éste se encargue de crear un directorio para el usuario, en caso de que no esté ya, y se retorna que la operación ha tenido éxito, mediante un mensaje de tipo JSON, dando por finalizado el envío de información por parte del servidor.</p>
<pre><code><span class="hl-5">conexion</span><span class="hl-1">.</span><span class="hl-3">on</span><span class="hl-1">(</span><span class="hl-4">&#39;nuevoUsuario&#39;</span><span class="hl-1">, () </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">&#39;Acción añadir nuevo USUARIO&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-5">coleccionfunkos1</span><span class="hl-1"> : </span><span class="hl-11">ColeccionFunkos</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">ColeccionFunkos</span><span class="hl-1">(</span><span class="hl-5">informacionPeticion</span><span class="hl-1">.</span><span class="hl-5">nombreUsuario</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">conexion</span><span class="hl-1">.</span><span class="hl-3">write</span><span class="hl-1">(</span><span class="hl-2">JSON</span><span class="hl-1">.</span><span class="hl-3">stringify</span><span class="hl-1">({</span><span class="hl-4">&#39;operacion&#39;</span><span class="hl-5">:</span><span class="hl-1"> </span><span class="hl-4">&#39;exito&#39;</span><span class="hl-1">}));</span><br/><span class="hl-1">    </span><span class="hl-5">conexion</span><span class="hl-1">.</span><span class="hl-3">end</span><span class="hl-1">();</span><br/><span class="hl-1">});</span>
</code></pre>
<p>Al detectar la perdida de conexión con el cliente, mediante un <code>close</code> se indica que se ha desconectado el cliente, volviendo a esperar a la conexión de nuevos clientes.</p>
<pre><code><span class="hl-5">conexion</span><span class="hl-1">.</span><span class="hl-3">on</span><span class="hl-1">(</span><span class="hl-4">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">&quot;¡Un cliente se ha desconectado!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#cliente" id="cliente" style="color: inherit; text-decoration: none;">
  <h3>Cliente</h3>
</a>
<p>El cliente comienza su ciclo de ejeccución recibiendo por parte del usuario, en línea de comandos la información sobre qué se acción se desea realizar.</p>
<p>En este fragmento de código vemos la opción para añadir un nuevo usuario, <code>nuevoUsuario</code>, en la que el usuario introduce el nombre del usuario en cuestión, rellenando el cliente la información de la petición con el nombre de usuario proporcionado por el ususario y la acción a realizar, que en este caso es <code>nuevoUsuario</code>, que cuando establezcamos conexión con el servidor enviaremos en la petición.</p>
<pre><code><span class="hl-3">yargs</span><span class="hl-1">(</span><span class="hl-3">hideBin</span><span class="hl-1">(</span><span class="hl-5">process</span><span class="hl-1">.</span><span class="hl-5">argv</span><span class="hl-1">))</span><br/><span class="hl-1">  .</span><span class="hl-3">command</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;nuevoUsuario&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;Añadir un nuevo usuario&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-5">nombreUsuario:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-4">&quot;Nombre del usuario&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">type:</span><span class="hl-1"> </span><span class="hl-4">&quot;string&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">demandOption:</span><span class="hl-1"> </span><span class="hl-0">true</span><span class="hl-1">,</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    (</span><span class="hl-5">argv</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">informacionPeticion</span><span class="hl-1"> = {</span><span class="hl-5">nombreUsuario:</span><span class="hl-1"> </span><span class="hl-5">argv</span><span class="hl-1">.</span><span class="hl-5">nombreUsuario</span><span class="hl-1">, </span><span class="hl-5">accion:</span><span class="hl-1"> </span><span class="hl-4">&#39;nuevoUsuario&#39;</span><span class="hl-1">};</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  )</span>
</code></pre>
<p>El cliente establece una conexión con el servidor en el puerto <code>60500</code>, enviando un mensaje de tipo JSON con la información de la petición en cuestión que, como ya hemos comentado, contiene el nombre del usuario sobre el que se desea realizar las gestiones, opcional un id que corresponde con el del funko, la acción que desea realizar (añadir nuevo usuario, añadir funko, modificar funko, eliminar funko, mostrar información de un funko en concreto o listar los funkos de un usuario) y, opcionalmente, un objeto de tipo funko.</p>
<pre><code><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">cliente</span><span class="hl-1"> = </span><span class="hl-5">net</span><span class="hl-1">.</span><span class="hl-3">connect</span><span class="hl-1">({</span><span class="hl-5">port:</span><span class="hl-1"> </span><span class="hl-10">60500</span><span class="hl-1">}, () </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">cliente</span><span class="hl-1">.</span><span class="hl-3">write</span><span class="hl-1">(</span><span class="hl-2">JSON</span><span class="hl-1">.</span><span class="hl-3">stringify</span><span class="hl-1">({</span><span class="hl-4">&#39;peticion&#39;</span><span class="hl-5">:</span><span class="hl-1"> </span><span class="hl-5">informacionPeticion</span><span class="hl-1">}));</span><br/><span class="hl-1">});</span>
</code></pre>
<p>Acto seguido, capturamos la respuesta por parte del servidor:</p>
<pre><code><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-5">respuesta</span><span class="hl-1"> = </span><span class="hl-4">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">cliente</span><span class="hl-1">.</span><span class="hl-3">on</span><span class="hl-1">(</span><span class="hl-4">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-5">chunk</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">respuesta</span><span class="hl-1"> += </span><span class="hl-5">chunk</span><span class="hl-1">;</span><br/><span class="hl-1">});</span>
</code></pre>
<p>El cliente la procesa en función de sí el servidor ha retornado que la operación ha realizar ha tenido éxito o error:</p>
<pre><code><span class="hl-5">cliente</span><span class="hl-1">.</span><span class="hl-3">on</span><span class="hl-1">(</span><span class="hl-4">&#39;end&#39;</span><span class="hl-1">, () </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">mensajeRecibido</span><span class="hl-1"> = </span><span class="hl-2">JSON</span><span class="hl-1">.</span><span class="hl-3">parse</span><span class="hl-1">(</span><span class="hl-5">respuesta</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">respuestaAuxiliar</span><span class="hl-1"> = </span><span class="hl-5">mensajeRecibido</span><span class="hl-1">.</span><span class="hl-5">operacion</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-8">if</span><span class="hl-1">(</span><span class="hl-5">mensajeRecibido</span><span class="hl-1">.</span><span class="hl-5">operacion</span><span class="hl-1"> === </span><span class="hl-4">&#39;error&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-5">chalk</span><span class="hl-1">.</span><span class="hl-5">bold</span><span class="hl-1">.</span><span class="hl-3">red</span><span class="hl-1">(</span><span class="hl-4">`La operación </span><span class="hl-0">${</span><span class="hl-5">informacionPeticion</span><span class="hl-9">.</span><span class="hl-5">accion</span><span class="hl-0">}</span><span class="hl-4"> NO se ha podido realizar`</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-8">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-5">chalk</span><span class="hl-1">.</span><span class="hl-5">bold</span><span class="hl-1">.</span><span class="hl-3">green</span><span class="hl-1">(</span><span class="hl-4">`La operación </span><span class="hl-0">${</span><span class="hl-5">informacionPeticion</span><span class="hl-9">.</span><span class="hl-5">accion</span><span class="hl-0">}</span><span class="hl-4"> se ha realizado de manera exitosa`</span><span class="hl-1">));</span><br/><br/><span class="hl-1">    </span><span class="hl-8">if</span><span class="hl-1"> (</span><span class="hl-5">informacionPeticion</span><span class="hl-1">.</span><span class="hl-5">accion</span><span class="hl-1"> == </span><span class="hl-4">&#39;mostrar&#39;</span><span class="hl-1"> || </span><span class="hl-5">informacionPeticion</span><span class="hl-1">.</span><span class="hl-5">accion</span><span class="hl-1"> == </span><span class="hl-4">&#39;listar&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">for</span><span class="hl-1"> (</span><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-5">i</span><span class="hl-1"> = </span><span class="hl-10">0</span><span class="hl-1">; </span><span class="hl-5">i</span><span class="hl-1"> &lt; </span><span class="hl-5">mensajeRecibido</span><span class="hl-1">.</span><span class="hl-5">funkos</span><span class="hl-1">.</span><span class="hl-5">length</span><span class="hl-1">; </span><span class="hl-5">i</span><span class="hl-1">++) {</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`**** ID: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_ID</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Nombre: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_nombre</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Descripción: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_descripcion</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Tipo: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_tipo</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Género: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_genero</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Franquicia: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_franquicia</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Número: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_numero</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Exclusivo: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_exclusivo</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`Características especiales: </span><span class="hl-0">${</span><span class="hl-5">mensajeRecibido</span><span class="hl-9">.</span><span class="hl-5">funkos</span><span class="hl-9">[</span><span class="hl-5">i</span><span class="hl-9">].</span><span class="hl-5">_caracteristicasEspeciales</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-3">rangoValoresMercado</span><span class="hl-1">(</span><span class="hl-5">mensajeRecibido</span><span class="hl-1">.</span><span class="hl-5">funkos</span><span class="hl-1">[</span><span class="hl-5">i</span><span class="hl-1">].</span><span class="hl-5">_valorMercado</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-4">`****`</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span>
</code></pre>
<p>Si ha habido un error se notifica empleando <code>chalk</code>, en caso contrario, se notifica con un mensaje de éxito o, en su caso, con la información solicitada por parte del usuario.</p>

<a href="#conclusión" id="conclusión" style="color: inherit; text-decoration: none;">
  <h1>Conclusión</h1>
</a>
<p>Como hemos comentado en esta práctica nos hemos podido introducir en nuevos conceptos y herramientas para que los usuarios interactúen con los programas de distintas formas y mostrar por consola los textos con distintas tonalidades y manera de resaltar. A su vez, con las maneras de intercambiar información y paquetes de información, desde tipo JSON como mensajes de textos normales y corrientes, entre un programa que emula a un servidor y otros que lo hacen como clientes. </p>

<a href="#referencias" id="referencias" style="color: inherit; text-decoration: none;">
  <h1>Referencias</h1>
</a>
<p>Para el desarrollo de la práctica se ha requerido la consulta de los siguientes recursos:</p>
<ul>
<li><a href="https://frikily.com/cuanto-vale-mi-funko-pop/">https://frikily.com/cuanto-vale-mi-funko-pop/</a></li>
<li><a href="https://www.npmjs.com/package/yargs">https://www.npmjs.com/package/yargs</a></li>
<li><a href="https://www.npmjs.com/package/chalk">https://www.npmjs.com/package/chalk</a></li>
<li><a href="https://www.npmjs.com/package/jsonfile">https://www.npmjs.com/package/jsonfile</a></li>
<li><a href="https://www.npmjs.com/package/@types/node">https://www.npmjs.com/package/@types/node</a></li>
<li><a href="https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/node/fs/promises.d.ts">https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/node/fs/promises.d.ts</a></li>
<li><a href="https://nodejs.org/docs/latest-v19.x/api/fs.html#synchronous-api">https://nodejs.org/docs/latest-v19.x/api/fs.html#synchronous-api</a></li>
</ul>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">ull-<wbr/>esit-<wbr/>inf-<wbr/>dsi-<wbr/>22-<wbr/>23-<wbr/>prct10-<wbr/>fs-<wbr/>proc-<wbr/>sockets-<wbr/>funko-<wbr/>app-<wbr/>alu0101333588</a>
<ul>
<li class="tsd-kind-module"><a href="modules/ejercicio1.html">ejercicio1</a></li>
<li class="tsd-kind-module"><a href="modules/ejercicio2.html">ejercicio2</a></li>
<li class="tsd-kind-module"><a href="modules/ejercicio2_pipe.html">ejercicio2-<wbr/>pipe</a></li>
<li class="tsd-kind-module"><a href="modules/ejercicio3_Funko.html">ejercicio3/<wbr/>Funko</a></li>
<li class="tsd-kind-module"><a href="modules/ejercicio3_cliente.html">ejercicio3/cliente</a></li>
<li class="tsd-kind-module"><a href="modules/ejercicio3_genero.html">ejercicio3/genero</a></li>
<li class="tsd-kind-module"><a href="modules/ejercicio3_servidor.html">ejercicio3/servidor</a></li>
<li class="tsd-kind-module"><a href="modules/ejercicio3_tipoPop.html">ejercicio3/tipo<wbr/>Pop</a></li></ul></li></ul></div></details></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>